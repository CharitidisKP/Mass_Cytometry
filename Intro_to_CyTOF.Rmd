---
title: "Intro_to_CyTOF"
output: html_document
---

```{r Load the libraries}

library(flowCore)
library()

```

```{r}

BiocManager::install("")

```

```{r Load the files}

FCS_file_list <- list.files(path = "~/SLE/3TR/Base_Files", pattern = ".fcs", full.names = TRUE, ignore.case = TRUE)

## Load the first FCS file from the list ## 
FCS_Files <- read.FCS(filename = FCS_file_list[1], transformation = FALSE, truncate_max_range = FALSE)

## To load all files: ##
FCS_Files <- read.flowSet(files = FCS_file_list, transformation = FALSE, truncate_max_range = FALSE)

## Extract the expression matrix ##
Exp_matrix <- FCS_Files$exprs
FCS_Files$parameters$data

## Make the files more readable ##
Markers <- gsub(pattern = ".*_", replacement = "", x = as.vector(FCS_Files$parameters$data$desc)) ## The tutorial has it with @ FCS_Files@parameters@data$desc
colnames(Exp_matrix)[which(!is.na(Markers))] <- Markers[which(!is.na(Markers))] ## Re do this with the tidyverse

```

```{r Data preprocessing}
Pregating_Channels <- c("Bead", "DNA1", "DNA2", "Dead", "Event_length")

Lineage_Channels <- c("CD57", "CD19", "CD4", "CD8", "IgD", "CD11c",
                      "CD16", "CD3", "CD38", "CD27", "CD14", "CXCR5",
                      "CCR7", "CD45RA", "CD20", "CD127", "CD33", "CD28", 
                      "CD161", "TCRgd", "CD123", "CD56", "HLADR", "CD25")

Instrument_Channels <- c("Time", "Event_length", "Center", "Offset", "Width", "Residual")


```

